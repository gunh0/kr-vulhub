# OpenSSL 무한 루프를 통한 서비스 거부(DoS) 취약점 (CVE-2022-0778)

> WHS-3기 - 여서인 <br/>
<br/>

## 개요

OpenSSL 널리 사용되는 대부분의 대칭/비대칭 암호화 프로토콜을 구현한 오픈 소스 라이브러리로, 가장 대표적으로는 SSL/TLS와 관련된 기능들을 제공한다. 
본체는 C 라이브러리 형태이지만, Python Java 등 거의 대부분의 프로그래밍 언어별로 다양한 OpenSSL 바인딩이 존재한다.
인증서를 조작하여 무한 루프를 유발할 수 있는데, 무한 루프에 빠지면 %CPU가 100으로 오르고, 정상 작동해야하는 기능들에 영향을 줄 수 있다. 
주로 데이터 암호화, 인증서 생성 및 관리, 안전한 통신을 위해 사용되며, 다양한 네트워크 서비스와 애플리케이션에서 필수적으로 활용된다

<br/>

## 환경 구성
- 터미널에서 다음 명령어를 통해 서버를 시작합니다
```
docker compose up -d
```
![image](https://github.com/user-attachments/assets/c83e3515-b4c9-4f27-a35d-af91933c7a6b)


<br/>

## 취약점 재현
먼저 https://github.com/summin02/cve-2022-0778.git 저장소를 참고하여 악성 서버를 구축하고 실행한다.

### 1. 악성 서버를 실행
악성 서버를 실행하기 위하여 터미널에 해당 명령어를 실행한다.<br/>
![image](https://github.com/user-attachments/assets/7af72f46-4d4b-4a88-8493-7cb9bd742e06)

<br/><br/>

### 2. 컨테이너 내부에서 CPU 사용량을 모니터링
컨테이너 내부에서 CPU 사용량을 모니터링 하기 위하여 새로운 터미널에서 다음 명령어를 실행한다.
```
docker compose exec curl top
```

- CPU 사용량 모니터링 예시
![image](https://github.com/user-attachments/assets/59af9491-29c4-4179-b690-641a3855f588)

<br/><br/>

### 3. 만들어진 도커 환경에 진입, 악성 서버 접속
다음 명령어를 통해 만들어진 도커 환경에 진입한다.<br/>
이어서 앞서 띄운 악성 서버로 접속을 시도한다.

```
docker compose exec curl bash
curl -k https://host.docker.internal:12345
```
- 도커 환경진입 예시
![image](https://github.com/user-attachments/assets/356490ad-6bed-4652-b7f2-7ccd227594ce)

<br/><br/>


### 4. CPU 점유율 확인
- CPU는 100% 까지 소모하게 된다.
![image](https://github.com/user-attachments/assets/e0b46ed8-29ac-429a-91ea-759a7f6c8b70)


<br/>

<br/>

## 재현 결과 요약
curl 명령어를 통해 악성 서버에 접속 시, 프로세스가 정상 종료되지 않고 무한 루프에 빠진다.

top 명령어로 확인 시, curl 프로세스가 CPU 자원을 100% 가까이 지속적으로 점유한다.

이는 OpenSSL이 잘못된 타원 곡선 매개변수를 가진 인증서를 파싱하는 과정에서 발생하는 문제로, 시스템 자원 고갈을 통한 서비스 거부(DoS) 공격이 가능함을 확인할 수 있다.

<br/>

조작된 인증서를 통해 OpenSSL이 무한 루프에 빠지는 취약점(CVE-2022-0778)은 서비스 거부(DoS) 공격으로 악용될 수 있다. 실제로 CPU 자원이 과다 사용되면서 정상적인 서비스 운영에 심각한 장애를 초래할 수 있음을 실습을 통해 검증하였다.

<br> 
