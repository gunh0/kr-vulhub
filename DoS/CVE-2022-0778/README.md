# OpenSSL 무한 루프를 통한 서비스 거부(DoS) 취약점 (CVE-2022-0778)

> WHS-3기 - [주수민 (@summin02)](https://github.com/summin02)

<br/>

### 개요

OpenSSL은 컴퓨터 네트워크 상에서 통신을 보호하거나, 통신 상대방을 식별해야 하는 애플리케이션을 위한 소프트웨어 라이브러리이다.

공격자가 잘못된 타원 곡선(elliptic curve) 매개변수를 가진 인증서를 조작하여, 무한 루프를 유발할 수 있다.
인증서 파싱 과정은 서명 검증 이전에 이루어지기 때문에, 외부에서 제공된 인증서를 처리하는 모든 프로세스가 이 취약점에 의해 서비스 거부(DoS) 공격을 받을 수 있다.

<br/>

### 요약
- 잘못된 타원 곡선 매개변수를 가진 인증서를 파싱하는 과정에서 무한 루프 발생
- 해당 프로세스는 정상적인 작업을 수행하지 못하고 CPU를 소모하며 서비스 거부(DoS) 상태에 빠짐
- 이 문제는 외부 입력을 처리하는 모든 OpenSSL 사용자에게 영향을 줄 수 있음

<br/>

### 환경 구성
- 터미널에서 다음 명령어를 통해 서버를 시작합니다
```
docker compose up -d
```

<br/>

### 취약점 재현
먼저, 악성 서버를 실행해야 한다.
Golang 컴파일러가 설치되어 있지 않은 경우, Docker 이미지를 사용할 수 있다
- 터미널에서 다음 명령어를 통해 악성 서버를 실행한다.
```
docker run -it --rm -p 12345:12345 yywing/cve-2022-0778 --addr 0.0.0.0:12345
```
- 이후 컨테이너 내부에서 CPU 사용량을 모니터링하기 위해 새로운 터미널에서 다음 명령어를 실행한다.
```
docker compose exec curl top
```
- 이후 다음 명령어를 통해 만들어진 도커 환경에 진입한다.
```
docker compose exec curl bash
```
- 이어서 다음 명령어를 통해 앞서 띄운 악성 서버로 접속한다.
```
curl -k https://host.docker.internal:12345
```
- 이 시점에서, cURL은 무한 루프에 빠지게 되고 CPU 리소스를 과다 소모하게 된다.

<br/>

### poc.py

내용 작성

<br/>

### 결과

![](result.png)

<br/>

### 정리

내용 작성
