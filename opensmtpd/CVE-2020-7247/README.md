# OpenSMTPD 원격 코드 실행 취약점 (CVE-2020-7247)

OpenSMTPD는 RFC 5321 SMTP 프로토콜의 유닉스 운영 체제(BSD, MacOS, GNU/Linux)용 smtp 서비스 프로그램입니다. 
'CVE-2020-7247'은 RFC 5321을 구현하는 과정에서 OpenSMTPD의 발신자/수신자 확인이 느슨하여 발생합니다.

**참조：**
- https://www.qualys.com/2020/01/28/cve-2020-7247/lpe-rce-opensmtpd.txt
- https://www.exploit-db.com/exploits/47984

## 취약점 재현

Start a vulnerable OpenSMTPD through following command:

```
docker compose up -d
```

After SMTPD server is started, connect to the 8825 port and get the result (`44dadcc5a6eb` is the container ID):

```
$ nc <your-ip> 8825 -v
220 44dadcc5a6eb ESMTP OpenSMTPD
```

## Vulnerability Reproduce

Use [Exploit-DB](https://www.exploit-db.com/exploits/47984) to gain a reverse shell:

```
python3 poc.py your-ip 8825 <command> 
```

![image](https://github.com/CatAndCoffee/vulhub/blob/CVE-2020-7247/OpenSMTPD/CVE-2020-7247/image-20210415233036042.png)
