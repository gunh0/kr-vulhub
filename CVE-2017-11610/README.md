# CVE-2017-11610 Supervisor 취약점 분석

**Contributors**
- [owen gong(@vulhub)](https://github.com/phith0n)
- Zh1z3ven (https://www.anquanke.com/member.html?memberId=155804)
- https://www.leavesongs.com/PENETRATION/supervisord-RCE-CVE-2017-11610.html
- https://blogs.securiteam.com/index.php/archives/3348
- https://github.com/Supervisor/supervisor/commit/90c5df80777bfec03d041740465027f83d22e27b

<br/>

### 요약
공격자가 XStream 라이브러리르 사용하여 역지렬화를 수행하는 REST 끝점에 XML 페이로드를 전송하여 대상 시스템(target)에서 코드를 실행할 수 있게 한다.
Supervisor 취약점을 이용하면 원격 공격을 통해 공격자가 시스템에 대한 권환을 얻어 애플리케이션에 임의로 명령을 줄 수 있기 때문에 잠재적인 보안 위험이 될 수 있다.
위험 방지를 위해 취약점을 개선한 최신 버전을 사용할 것을 권고하고 있다.

취약점 분석은 Supervisor 3.3.2버전으로 진행하였으며 파일에서 사용되는 Supervisor는 C/S 모델의 프로그램, supervisord는 server단, supervisorctl은 Client단이다.
클라이언트(supervisorctl)은 supervisor의 명령을 입력하여 server단(supervisord)의 API를 호출하여 프로세스 관리와 같은 일부 관리를 진행합니다.


### 환경설정
-   `docker compose up -d`를 실행하여 테스트 환경을 실행함.
-   `http://your-ip:9001/`에 접속하여 Supervisor 페이지 접속 및 네트워크 확인
-   `python3 poc.py http://your-ip:9001/`를 호출하여 반환 결과를 읽음. 


### 결과

![Image](https://github.com/Revivekirin/cybersecurity/assets/139988539/50c0af09-1495-495e-b2fc-50c5a182f1e1)


![Image](https://github.com/Revivekirin/cybersecurity/assets/139988539/97b059bd-c899-4ab3-89ab-e3ebf25216e3)

 `HTTP/1.1 200 OK
Content-Length: 1254
Expires: Thu, 01 Jan 1970 00:00:00 GMT
Server: Medusa/1.12
Pragma: no-cache
Cache-Control: no-cache
Date: Sun, 08 Oct 2023 07:15:40 GMT
Content-Type: text/html `



<image hierarchy에서 CVE-2017-11610 취약점 발견>
![Image](https://github.com/Revivekirin/cybersecurity/assets/139988539/010dae29-eeb3-4a5c-95d3-3356cb74af67)

<Layer에서 CVE-2017-11610 취약점 발견>
![Image](https://github.com/Revivekirin/cybersecurity/assets/139988539/5f5f6425-6808-4f42-900e-35dc5de1ac91)
