# 소스코드 분석 

취약점은 XML-RPC 호출에 문제가 있으므로 RPC 호출을 처리하는 supervisor_xmlrpc_handler 클래스를 추적하겠습니다.
supervisord.py 파일에서 http 요청으로 보낸 payload self.options.openhttpservers(self)를 찾았습니다. 

![Image](https://github.com/Revivekirin/cybersecurity/assets/139988539/bb701af9-8855-408f-99ea-80544225a2c0)


<br/>
ptions.py에 openhttpservers( ) 메서드가 정의되어 있습니다.

![Image](https://github.com/Revivekirin/cybersecurity/assets/139988539/1ddf0110-f8c2-44f3-9021-d94c731ef3dd)


http.py에 make_http_servers 함수가 정의되어 있고 xmlrpc 라이브러리에서 supervisor_xmlrpc_handler를 임포트 합니다.

![Image](https://github.com/Revivekirin/cybersecurity/assets/139988539/6df2ff4c-659d-427e-b088-d30f50d32cab)

<br/>

![Image](https://github.com/Revivekirin/cybersecurity/assets/139988539/05ccd8d5-d9b8-4b3b-827e-fbc14944f217)

xmlrpc.py에서 정의된 supervisor_xmlrpc_handler 클래스는 최종적으로 RPC 호출을 처리합니다. 

여기에서 supervisor_xmlrpc_handler 클래스에서 call 메서드를 정의한 취약성 오류의 traverse 메서드를 찾았고, 이 메서드 traverse(self.rpcinterface, method, params)에서 전달된 method, params 매개변수를 확인합니다.



![Image](https://github.com/Revivekirin/cybersecurity/assets/139988539/62486af9-27e8-459c-b9ed-f5652444f902)

즉, methodName=supervisor.startProcess, params= 시작할 서비스 이름


![Image](https://github.com/Revivekirin/cybersecurity/assets/139988539/18b78ee7-5510-43cd-9af0-596de26a1d73)

1. method 문자열을 '.'으로 구분한 값들을 path에 저장한다.
2. ob가 '_'로 시작되지 않으면 ob=getattr(ob, name, None)을 실행하고 name의 값이 method이면 ob에 할당합니다. path = supervisord.options.warnings.linecache.os.system( )이라면 마지막으로 ob가 system( )을 획득하고 params(실행할 명령어) 매개 변수를 이 메서드로 가져와 실행하고 결과를 반환합니다.

