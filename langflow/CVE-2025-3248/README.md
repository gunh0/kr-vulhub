# Langflow CVE-2025-3248 인증 우회 원격 코드 실행

화이트햇 스쿨 3기 27반_이윤희(4081)

---

# 1. 개요

Langflow는 에이전트 기반 AI 워크플로우를 시각적으로 구축할 수 있도록 지원하는 Python 기반 오픈소스 플랫폼입니다. 최근 Langflow에는 여러 보안 취약점이 보고된 바 있으나, CVE-2025-3248은 특히 심각한 영향을 미치는 취약점입니다.

CVE-2025-3248은 Langflow 1.3.0 미만 버전에서 발생하는 인증되지 않은 원격 코드 실행(RCE) 취약점입니다. 문제는 `/api/v1/validate/code` 엔드포인트가 사용자로부터 입력받은 Python 코드를 AST 파싱과정 없이 직접 `exec()` 함수로 실행하면서 발생합니다. 특히 Python 데코레이터나 기본 인수 표현식이 함수 정의 단계에서 바로 실행되기 때문에, 공격자가 악성 코드를 삽입할 수 있습니다.


# 2. 환경 구성

## 2.1 실습 환경

OS : Windows 11

사용 도구 : Docker Desktop, Burp Suite Community Edition

실습 대상 : Langflow 1.2.0 (vulhub 환경)


## 2.2 Docker 기반 Langflow 서버 구축

- docker-compose.yml
```yaml
services:
  web:
    image: vulhub/langflow:1.2.0
    ports:
      - 7860:7860
    environment:
      - LANGFLOW_HOST=0.0.0.0
      - LANGFLOW_AUTO_LOGIN=false
      - LANGFLOW_SUPERUSER=administrator
      - LANGFLOW_SUPERUSER_PASSWORD=vulhub
      - DO_NOT_TRACK=true
      - GIT_PYTHON_REFRESH=quiet
```

- Docker clone
```bash
git clone https://github.com/본인아이디/vulhub.git
cd vulhub/langflow/CVE-2025-3248
docker-compose up -d
```

- Langflow 서버 로그인
![image.png](attachment:cc156d67-f7ea-4bdb-bcf6-1c7a7cc0e34d:7bdb3140-c053-4672-ac45-b71d169936f8.png)
