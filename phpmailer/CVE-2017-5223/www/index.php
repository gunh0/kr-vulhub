<?php
require 'vendor/autoload.php';

if (isset($_POST['your-name'], $_POST['your-email'], $_POST['your-message'])) {
    $mail = new PHPMailer();
    $mail->isSMTP();
    $mail->Host = $_ENV['SMTP_SERVER'];
    $mail->SMTPAuth = true;
    $mail->Username = $_ENV['SMTP_EMAIL'];
    $mail->Password = $_ENV['SMTP_PASSWORD'];
    $mail->Port = intval($_ENV['SMTP_PORT']);
    $mail->CharSet = 'UTF-8';
    if (in_array($_ENV['SMTP_SECURE'], ['tls', 'ssl'])) {
        $mail->SMTPSecure = $_ENV['SMTP_SECURE'];
    } else {
        $mail->SMTPSecure = false;
    }

    $message = <<<DATA
<p><strong>{$_POST['your-name']}</strong>님 안녕하세요. 입력해주신 의견은 다음과 같습니다：</p>

<blackquote>{$_POST['your-message']}</blockquote>

<p>24시간 이내에 답변드릴 예정이오니, 조금만 기다려주세요!</p>
DATA;
    $mail->SetFrom($_POST["your-email"], $_POST["your-name"]);
    $mail->AddAddress($_POST["your-email"], $_POST["your-name"]);
    $mail->Subject = "피드백이 접수되었습니다.";
    $mail->MsgHTML($message);
    if(!$mail->Send()) echo "Error: ".$mail->ErrorInfo; else echo "Success!";
}
?>
<html>
<head>
<meta charset="UTF-8">
</head>
<body>
<h2>피드백</h2>
<form method="post">
<p><label>이름<br /><input type="text" name="your-name" value="" size="40" /></span> </label></p>
<p><label>이메일<br /><input type="email" name="your-email" value="" size="40" /></span> </label></p>
<p><label>의견<br /><textarea name="your-message" cols="40" rows="10"></textarea></label></p>
<p><input type="submit" value="제출" /></p>
</body>
</html>