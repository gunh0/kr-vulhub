# CVE-2012-1823

**Contributors**

-   [WHS 1기 5반 김태영](https://studykty.tistory.com/)

<br/>

### 요약

-   PHP 5.4.2 이전 버전 또는 5.3.12 버전에서 원격 코드 실행(RCE, Remote Code Execution)이 가능한 취약점 발생했습니다.
-   php에는 웹 서버와 외부 프로그램 간의 상호 작용을 가능하게 하는 표준 프로토콜인 CGI가 존재합니다.
-   sapi/cgi/cgi_main.c 파일 내에 존재하는 php-cgi가 -s, -d와 같은 매개 변수를 검증하지 않아 취약점이 발생했습니다.

<br/>

### 환경 구성

-   `docker compose up -d`를 실행하여 테스트 환경을 실행함.
-   `http://your-ip:8080/`에 접속하여 기본 페이지를 확인합니다.
-   정상적으로 테스트 환경이 구축됐다면, 아래 사진과 같이 페이지에 "Hello, Your name is Vulhub"라는 문장이 출력되어야 합니다.
![](1.png)

<br/>

### 취약점 구현 증명

-   ㅁㄴㅇㄹㄴㄹ
![](1.png)

<br/>

### 결과

![](result.png)

<br/>

### 정리

-   이 취약점은 공격자가 Nginx 서버의 캐시 파일에서 예상치 못한 데이터를 읽을 수 있게 만들어, 정보 유출의 위험이 있음. 안전한 웹 서비스 운영을 위해서는 이러한 취약점을 주기적으로 확인하고 패치하는 것이 중요함.
