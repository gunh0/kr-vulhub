# Next.js Middleware Authorization Bypass (CVE-2025-29927)
> 화이트햇스쿨 3기 17반 박민영

## 1. Next.js 미들웨어 인증 우회 취약점이란?
이 취약점은 Next.js 웹 프레임워크에서 발생하는 보안 취약점으로, 공격자가 미들웨어 기반의 인증 절차를 우회하여 시스템에 접근할 수 있게 한다.
공격자는 특정 값을 가진 `x-middleware-subrequest` 헤더를 추가함으로써 미들웨어를 우회할 수 있으며, 이를 통해 인증되지 않은 사용자가 인증이 필요한 페이지에 무단으로 접속하여 공격할 수 있다. 

## 2. 취약한 환경 구성

## 3. 취약점 재현

## 4. 취약점 대처 방안
해당 취약점이 수정된 버전으로 업그레이드하여 사용하여야 한다.
- Next.js 15.x → 15.2.3
- Next.js 14.x → 14.2.25
  
업그레이드하지 못하거나 아래의 버전의 경우 `x-middleware-subrequest` 헤더가 포함된 외부 요청이 애플리케이션에 도달하지 못하도록 해당 헤더를 제거하거나 차단하도록 구성하여야 한다.
- Next.js 11.1.4~13.5.6 

## 5. 참고자료
[vulhub/next.js/CVE-2025-29927(영어)
](https://github.com/vulhub/vulhub/tree/master/next.js/CVE-2025-29927/README.md)</br>
[vulhub/next.js/CVE-2025-29927(중국어)](https://github.com/vulhub/vulhub/tree/master/next.js/CVE-2025-29927/README.zh-cn.md)</br>
[CVE-2025-29927: Next.js Middleware Authorization Bypass - Technical Analysis](https://projectdiscovery.io/blog/nextjs-middleware-authorization-bypass)</br>
[Next.js and the corrupt middleware: the authorizing artifact](https://zhero-web-sec.github.io/research-and-things/nextjs-and-the-corrupt-middleware)
